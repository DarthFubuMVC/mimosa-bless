var bless, blessAll, blessCommand, blessFile, checkForBless, cleanBlessed, color, fs, gatherFiles, logger, path, printObj, trackCompletion, wrench, _, _ref;

bless = require('bless');

fs = require('fs');

path = require('path');

logger = require('logmimosa');

color = require('ansi-color').set;

_ = require('lodash');

wrench = require('wrench');

_ref = require('./util'), printObj = _ref.printObj, trackCompletion = _ref.trackCompletion;

blessFile = function(input, output, options, next) {
  if (!fs.existsSync(input)) {
    return logger.warn("mimosa-bless: bless file [[ " + input + " ]] does not exist");
  }
  logger.info("Blessing [[ " + input + " ]]");
  return fs.readFile(input, 'utf-8', function(e, data) {
    var settings;
    if (e) {
      logger.error("blessc: " + e.message);
      next();
    }
    logger.debug("finished reading file[[ " + input + " ]]");
    settings = {
      output: output,
      options: options
    };
    logger.debug("running bless parser on [[ " + input + " ]]");
    return new bless.Parser(settings).parse(data, function(err, files, numSelectors) {
      var numFiles;
      if (err) {
        logger.error("blessc: " + e.message);
        return next();
      } else {
        numFiles = files.length;
        logger.info("Source CSS file [[ " + input + " ]] contained " + numSelectors + " selectors");
        if (numFiles > 1 || input !== output) {
          _.each(files, function(file) {
            var fd;
            fd = fs.openSync(file.filename, 'w');
            return fs.writeSync(fd, file.content, 0, 'utf-8');
          });
          logger.success(" " + numFiles + " CSS files created for " + input);
        } else {
          logger.success("No changes made.");
        }
        return next();
      }
    });
  });
};

cleanBlessed = function(mimosaConfig, options, next) {
  return next();
};

checkForBless = function(mimosaConfig, options, next) {
  return next();
};

gatherFiles = function(filesFromOptions) {
  return _(filesFromOptions).map(function(entry) {
    if (fs.statSync(entry).isDirectory()) {
      return wrench.readdirSyncRecursive(entry).filter(function(f) {
        return (path.extname(f)) === ".css";
      }).map(function(f) {
        return path.join(entry, f);
      });
    } else {
      return [entry];
    }
  }).flatten().uniq().value();
};

blessAll = function(mimosaConfig, options, next) {
  var blessOnWatch, files, finish, isBuild, settings, sources, uniqueInputs;
  isBuild = mimosaConfig.isBuild;
  settings = mimosaConfig.bless.options;
  files = gatherFiles(mimosaConfig.bless.files);
  blessOnWatch = mimosaConfig.bless.blessOnWatch;
  logger.debug("bless files: " + files);
  logger.debug("blessOnWatch: " + blessOnWatch);
  logger.debug("isBuild: " + isBuild);
  if (!(blessOnWatch || isBuild)) {
    next();
    return;
  }
  logger.info("Blessing files");
  sources = _.map(files, function(value, key) {
    var input, output;
    input = _.isString(key) ? key : value;
    output = value;
    return {
      input: input,
      output: output
    };
  });
  uniqueInputs = _.map(sources, function(_arg) {
    var input, output;
    input = _arg.input, output = _arg.output;
    return input;
  });
  finish = trackCompletion("blessSources", uniqueInputs, next);
  return _.each(sources, function(_arg) {
    var input, output;
    input = _arg.input, output = _arg.output;
    return blessFile(input, output, settings, function() {
      return finish(input);
    });
  });
};

blessCommand = function(retrieveConfig) {
  return retrieveConfig(false, function(config) {
    config.isBuild = true;
    return blessAll(config, {}, (function() {}));
  });
};

module.exports = {
  blessAll: blessAll,
  checkForBless: checkForBless,
  cleanBlessed: cleanBlessed,
  blessCommand: blessCommand
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL3NtaXRobS9kZXYvbWltb3NhLWJsZXNzL2xpYi9ibGVzc2VyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiL1VzZXJzL3NtaXRobS9kZXYvbWltb3NhLWJsZXNzL3NyYy9ibGVzc2VyLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxJQUFBLHVKQUFBOztBQUFBLEtBQUEsR0FBUSxPQUFBLENBQVEsT0FBUixDQUFSLENBQUE7O0FBQUEsRUFDQSxHQUFLLE9BQUEsQ0FBUSxJQUFSLENBREwsQ0FBQTs7QUFBQSxJQUVBLEdBQU8sT0FBQSxDQUFRLE1BQVIsQ0FGUCxDQUFBOztBQUFBLE1BR0EsR0FBUyxPQUFBLENBQVEsV0FBUixDQUhULENBQUE7O0FBQUEsS0FJQSxHQUFRLE9BQUEsQ0FBUSxZQUFSLENBQXFCLENBQUMsR0FKOUIsQ0FBQTs7QUFBQSxDQUtBLEdBQUksT0FBQSxDQUFRLFFBQVIsQ0FMSixDQUFBOztBQUFBLE1BTUEsR0FBUyxPQUFBLENBQVEsUUFBUixDQU5ULENBQUE7O0FBQUEsT0FPOEIsT0FBQSxDQUFRLFFBQVIsQ0FBOUIsRUFBQyxnQkFBQSxRQUFELEVBQVcsdUJBQUEsZUFQWCxDQUFBOztBQUFBLFNBU0EsR0FBWSxTQUFDLEtBQUQsRUFBUSxNQUFSLEVBQWdCLE9BQWhCLEVBQXlCLElBQXpCLEdBQUE7QUFDVixFQUFBLElBQUEsQ0FBQSxFQUFTLENBQUMsVUFBSCxDQUFjLEtBQWQsQ0FBUDtBQUNFLFdBQU8sTUFBTSxDQUFDLElBQVAsQ0FBYSw4QkFBQSxHQUE2QixLQUE3QixHQUFvQyxvQkFBakQsQ0FBUCxDQURGO0dBQUE7QUFBQSxFQUdBLE1BQU0sQ0FBQyxJQUFQLENBQWEsY0FBQSxHQUFhLEtBQWIsR0FBb0IsS0FBakMsQ0FIQSxDQUFBO1NBS0EsRUFBRSxDQUFDLFFBQUgsQ0FBWSxLQUFaLEVBQW1CLE9BQW5CLEVBQTRCLFNBQUMsQ0FBRCxFQUFJLElBQUosR0FBQTtBQUMxQixRQUFBLFFB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c0NvbnRlbnQiOlsiYmxlc3MgPSByZXF1aXJlICdibGVzcydcclxuZnMgPSByZXF1aXJlICdmcydcclxucGF0aCA9IHJlcXVpcmUgJ3BhdGgnXHJcbmxvZ2dlciA9IHJlcXVpcmUgJ2xvZ21pbW9zYSdcclxuY29sb3IgPSByZXF1aXJlKCdhbnNpLWNvbG9yJykuc2V0XHJcbl8gPSByZXF1aXJlICdsb2Rhc2gnXHJcbndyZW5jaCA9IHJlcXVpcmUgJ3dyZW5jaCdcclxue3ByaW50T2JqLCB0cmFja0NvbXBsZXRpb259ID0gcmVxdWlyZSAnLi91dGlsJ1xyXG5cclxuYmxlc3NGaWxlID0gKGlucHV0LCBvdXRwdXQsIG9wdGlvbnMsIG5leHQpIC0+XHJcbiAgdW5sZXNzIGZzLmV4aXN0c1N5bmMgaW5wdXRcclxuICAgIHJldHVybiBsb2dnZXIud2FybiBcIm1pbW9zYS1ibGVzczogYmxlc3MgZmlsZSBbWyAje2lucHV0fSBdXSBkb2VzIG5vdCBleGlzdFwiXHJcblxyXG4gIGxvZ2dlci5pbmZvIFwiQmxlc3NpbmcgW1sgI3tpbnB1dH0gXV1cIlxyXG5cclxuICBmcy5yZWFkRmlsZSBpbnB1dCwgJ3V0Zi04JywgKGUsIGRhdGEpIC0+XHJcbiAgICBpZiAoZSlcclxuICAgICAgbG9nZ2VyLmVycm9yIFwiYmxlc3NjOiBcIiArIGUubWVzc2FnZVxyXG4gICAgICBuZXh0KClcclxuXHJcbiAgICBsb2dnZXIuZGVidWcgXCJmaW5pc2hlZCByZWFkaW5nIGZpbGVbWyAje2lucHV0fSBdXVwiXHJcbiAgICBzZXR0aW5ncyA9IHtvdXRwdXQsIG9wdGlvbnN9XHJcblxyXG4gICAgbG9nZ2VyLmRlYnVnIFwicnVubmluZyBibGVzcyBwYXJzZXIgb24gW1sgI3tpbnB1dH0gXV1cIlxyXG4gICAgbmV3IGJsZXNzLlBhcnNlcihzZXR0aW5ncykucGFyc2UgZGF0YSwgKGVyciwgZmlsZXMsIG51bVNlbGVjdG9ycykgLT5cclxuICAgICAgaWYgKGVycilcclxuICAgICAgICBsb2dnZXIuZXJyb3IgXCJibGVzc2M6IFwiICsgZS5tZXNzYWdlXHJcbiAgICAgICAgbmV4dCgpXHJcbiAgICAgIGVsc2VcclxuICAgICAgICBudW1GaWxlcyA9IGZpbGVzLmxlbmd0aFxyXG4gICAgICAgIGxvZ2dlci5pbmZvIFwiU291cmNlIENTUyBmaWxlIFtbICN7aW5wdXR9IF1dIGNvbnRhaW5lZCAje251bVNlbGVjdG9yc30gc2VsZWN0b3JzXCJcclxuICAgICAgICBpZiAobnVtRmlsZXMgPiAxIHx8IGlucHV0ICE9IG91dHB1dClcclxuICAgICAgICAgIF8uZWFjaCBmaWxlcywgKGZpbGUpIC0+XHJcbiAgICAgICAgICAgIGZkID0gZnMub3BlblN5bmMgZmlsZS5maWxlbmFtZSwgJ3cnXHJcbiAgICAgICAgICAgIGZzLndyaXRlU3luYyBmZCwgZmlsZS5jb250ZW50LCAwLCAndXRmLTgnXHJcblxyXG4gICAgICAgICAgbG9nZ2VyLnN1Y2Nlc3MgXCIgI3tudW1GaWxlc30gQ1NTIGZpbGVzIGNyZWF0ZWQgZm9yICN7aW5wdXR9XCJcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICBsb2dnZXIuc3VjY2VzcyBcIk5vIGNoYW5nZXMgbWFkZS5cIlxyXG4gICAgICAgIG5leHQoKVxyXG5cclxuY2xlYW5CbGVzc2VkID0gKG1pbW9zYUNvbmZpZywgb3B0aW9ucywgbmV4dCkgLT5cclxuICAjVE9ETzogY2xlYW4gdXAgYW55IGdlbmVyYXRlZCBibGVzcyBmaWxlc1xyXG4gIG5leHQoKVxyXG5cclxuY2hlY2tGb3JCbGVzcyA9IChtaW1vc2FDb25maWcsIG9wdGlvbnMsIG5leHQpIC0+XHJcbiAgI1RPRE86IHN1cHBvcnQgYmxlc3NpbmcgaW4gd2F0Y2ggbW9kZSBpZiBmaWxlcyBnZXQgYWRkZWRcclxuICBuZXh0KClcclxuXHJcbmdhdGhlckZpbGVzID0gKGZpbGVzRnJvbU9wdGlvbnMpIC0+XHJcbiAgXyBmaWxlc0Zyb21PcHRpb25zXHJcbiAgICAubWFwIChlbnRyeSkgLT5cclxuICAgICAgaWYgZnMuc3RhdFN5bmMoZW50cnkpLmlzRGlyZWN0b3J5KClcclxuICAgICAgdGhlbiB3cmVuY2gucmVhZGRpclN5bmNSZWN1cnNpdmUoZW50cnkpLmZpbHRlciAoZikgLT5cclxuICAgICAgICAocGF0aC5leHRuYW1lIGYpID09IFwiLmNzc1wiXHJcbiAgICAgIC5tYXAgKGYpIC0+IHBhdGguam9pbiBlbnRyeSwgZlxyXG4gICAgICBlbHNlIFtlbnRyeV1cclxuICAgIC5mbGF0dGVuKClcclxuICAgIC51bmlxKClcclxuICAgIC52YWx1ZSgpXHJcblxyXG5ibGVzc0FsbCA9IChtaW1vc2FDb25maWcsIG9wdGlvbnMsIG5leHQpIC0+XHJcbiAgI1RPRE86IGZvciBzb21lIHJlYXNvbiB0aGlzIGdvZXMgcmVhbGx5IHNsb3cgaW4gd2F0Y2ggbW9kZVxyXG4gICN3aGVuIHdvcmtpbmcgd2l0aCBhIGxhcmdlIGNvZGUgYmFzZSwgbmVlZCB0byBpbnZlc3RpZ2F0ZVxyXG4gIGlzQnVpbGQgPSBtaW1vc2FDb25maWcuaXNCdWlsZFxyXG4gIHNldHRpbmdzID0gbWltb3NhQ29uZmlnLmJsZXNzLm9wdGlvbnNcclxuICBmaWxlcyA9IGdhdGhlckZpbGVzIG1pbW9zYUNvbmZpZy5ibGVzcy5maWxlc1xyXG5cclxuICBibGVzc09uV2F0Y2ggPSBtaW1vc2FDb25maWcuYmxlc3MuYmxlc3NPbldhdGNoXHJcblxyXG4gIGxvZ2dlci5kZWJ1ZyBcImJsZXNzIGZpbGVzOiAje2ZpbGVzfVwiXHJcbiAgbG9nZ2VyLmRlYnVnIFwiYmxlc3NPbldhdGNoOiAje2JsZXNzT25XYXRjaH1cIlxyXG4gIGxvZ2dlci5kZWJ1ZyBcImlzQnVpbGQ6ICN7aXNCdWlsZH1cIlxyXG4gIHVubGVzcyBibGVzc09uV2F0Y2ggb3IgaXNCdWlsZFxyXG4gICAgbmV4dCgpXHJcbiAgICByZXR1cm5cclxuXHJcbiAgbG9nZ2VyLmluZm8gXCJCbGVzc2luZyBmaWxlc1wiXHJcblxyXG4gICNUT0RPOiBzdXBwb3J0IG91dHB1dCBwZXIgZmlsZW5hbWUgdmlhIG9iamVjdCBlbnRyeSBpZiBkZXNpcmVkXHJcbiAgc291cmNlcyA9IF8ubWFwIGZpbGVzLCAodmFsdWUsIGtleSkgLT5cclxuICAgIGlucHV0ID0gaWYgXy5pc1N0cmluZyhrZXkpIHRoZW4ga2V5IGVsc2UgdmFsdWVcclxuICAgIG91dHB1dCA9IHZhbHVlXHJcbiAgICB7aW5wdXQsIG91dHB1dH1cclxuXHJcbiAgdW5pcXVlSW5wdXRzID0gXy5tYXAgc291cmNlcywgKHtpbnB1dCwgb3V0cHV0fSkgLT4gaW5wdXRcclxuXHJcbiAgZmluaXNoID0gdHJhY2tDb21wbGV0aW9uIFwiYmxlc3NTb3VyY2VzXCIsIHVuaXF1ZUlucHV0cywgbmV4dFxyXG5cclxuICBfLmVhY2ggc291cmNlcywgKHtpbnB1dCwgb3V0cHV0fSkgLT5cclxuICAgIGJsZXNzRmlsZSBpbnB1dCwgb3V0cHV0LCBzZXR0aW5ncywgKCkgLT4gZmluaXNoKGlucHV0KVxyXG5cclxuYmxlc3NDb21tYW5kID0gKHJldHJpZXZlQ29uZmlnKSAtPlxyXG4gIHJldHJpZXZlQ29uZmlnIGZhbHNlLCAoY29uZmlnKSAtPlxyXG4gICAgY29uZmlnLmlzQnVpbGQgPSB0cnVlXHJcbiAgICBibGVzc0FsbCBjb25maWcsIHt9LCAoLT4pXHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHtibGVzc0FsbCwgY2hlY2tGb3JCbGVzcywgY2xlYW5CbGVzc2VkLCBibGVzc0NvbW1hbmR9XHJcbiJdfQ==
